experiment_name : 'Double spring mass port-Hamiltonian NODE'
dataset_setup : 
  dataset_type : 'trajectory_multi_model'
  # train_dataset_file_name : [
  #   'Spring_Mass_training_2022-08-26-17-16-00.pkl',
  #   'Spring_Mass_training_2022-08-26-17-16-00.pkl'
  # ]
  # test_dataset_file_name : 'Double_Spring_Mass_testing_differences_2022-08-26-17-13-29.pkl'
  train_dataset_file_name : [
    'Spring_Mass_training_2022-09-04-18-35-03.pkl',
    'Spring_Mass_training_2022-09-04-18-35-03.pkl'
  ]
  test_dataset_file_name : 'Double_Spring_Mass_testing_differences_2022-09-04-18-42-43.pkl'
  dataset_path : '../environments/simulated_data'

model_setup:
  model_type : 'compositional_phnode'
  dt : 0.01
  input_dim : 4
  output_dim : 4
  J : [[0.0, 0.0, 1.0, 0.0], 
        [0.0, 0.0, -1.0, 1.0], 
        [-1.0, 1.0, 0.0, 0.0], 
        [0.0, -1.0, 0.0, 0.0]]
  R: [[0.0, 0.0, 0.0, 0.0],
      [0.0, 0.0, 0.0, 0.0],
      [0.0, 0.0, 0.0, 0.0],
      [0.0, 0.0, 0.0, 0.0]]
  G: [[0.0, 0.0, 0.0, 0.0],
      [0.0, 0.0, 0.0, 0.0],
      [0.0, 0.0, 0.0, 0.0],
      [0.0, 0.0, 0.0, 0.0]]
  num_submodels : 2
  submodel0_setup:
    model_type : 'hnode'
    dt : 0.01
    input_dim : 2
    output_dim: 2
    H_net_setup:
      model_type : 'mlp'
      input_dim : 2
      output_dim: 1
      nn_setup_params:
          output_sizes: [32, 32, 1]
          activation: 'tanh'
  submodel1_setup:
    model_type : 'hnode'
    dt : 0.01
    input_dim : 2
    output_dim: 2
    H_net_setup :
      model_type : 'mlp'
      input_dim : 2
      output_dim: 1
      nn_setup_params:
          output_sizes: [32, 32, 1]
          activation: 'tanh'

trainer_setup:
  trainer_type : 'compositional_phnode'
  num_subtrainers : 2
  num_training_steps : 10000
  subtrainer0_setup:
    minibatch_size: 32
    trainer_type: 'sgd'
    pen_l2_nn_params: 1e-12
    optimizer_setup:
      name: 'adam'
      learning_rate : !!float 1e-4
  subtrainer1_setup:
    minibatch_size: 32
    trainer_type: 'sgd'
    pen_l2_nn_params: 1e-12
    optimizer_setup:
      name: 'adam'
      learning_rate : !!float 1e-4